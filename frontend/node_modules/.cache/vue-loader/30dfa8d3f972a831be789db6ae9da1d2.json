{"remainingRequest":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/engine/Documents/D-VJ/QA2/qa/frontend/src/views/Question.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/src/views/Question.vue","mtime":1590773084255},{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1588785011040},{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/babel-loader/lib/index.js","mtime":1584985692138},{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1588785011040},{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/vue-loader/lib/index.js","mtime":1588785012576}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEFQSVNlcnZpY2UgfSBmcm9tICIuLi9jb21tb24vYXBpLnNlcnZpY2UuanMiOwppbXBvcnQgUHJldmVudFVubG9hZCBmcm9tICd2dWUtcHJldmVudC11bmxvYWQnOwppbXBvcnQgUXVlc3Rpb25BY3Rpb25zIGZyb20gIkAvY29tcG9uZW50cy9jb21tb24tY29tcG9uZW50cy9RdWVzdGlvbkFjdGlvbnMudnVlIjsKaW1wb3J0IEFuc3dlckNvbXBvbmVudCBmcm9tICJAL2NvbXBvbmVudHMvY29tbW9uLWNvbXBvbmVudHMvQW5zd2VyLnZ1ZSI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUXVlc3Rpb24iLAogIHByb3BzOiB7CiAgICBzbHVnOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEFuc3dlckNvbXBvbmVudCwKICAgIFF1ZXN0aW9uQWN0aW9ucywKICAgIFByZXZlbnRVbmxvYWQKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBxdWVzdGlvbjoge30sCiAgICAgIGFuc3dlcnM6IFtdLAogICAgICBuZXdBbnN3ZXJCb2R5OiBbXSwKICAgICAgZXJyb3I6IG51bGwsCiAgICAgIHVzZXJIYXNBbnN3ZXJlZDogZmFsc2UsCiAgICAgIHNob3dGb3JtOiBmYWxzZSwKICAgICAgbmV4dDogbnVsbCwKICAgICAgbG9hZGluZ0Fuc3dlcnM6IGZhbHNlLAogICAgICBoYXNDaGFuZ2VzOiB0cnVlLAogICAgICByZXF1ZXN0VXNlcjogbnVsbCwKICAgICAgc2hvd0VkaXRRdWVzdGlvbjogZmFsc2UsCiAgICAgIHF1ZXN0aW9uU2x1ZzogbnVsbCwKICAgICAgcXVlc3Rpb25Cb2R5OiBudWxsCiAgICB9OwogIH0sCgogIG1ldGhvZHM6IHsKICAgIHNldFJlcXVlc3RVc2VyKCkgewogICAgICAvLyB0aGUgdXNlcm5hbWUgaGFzIGJlZW4gc2V0IHRvIGxvY2FsU3RvcmFnZSBieSB0aGUgQXBwLnZ1ZSBjb21wb25lbnQKICAgICAgdGhpcy5yZXF1ZXN0VXNlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJhdXRob3IiKTsKICAgIH0sCiAgICBzZXRQYWdlVGl0bGUodGl0bGUpIHsKICAgICAgZG9jdW1lbnQudGl0bGUgPSB0aXRsZTsKICAgIH0sCiAgICBnZXRRdWVzdGlvbkRhdGEoKSB7CiAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL3F1ZXN0aW9ucy8ke3RoaXMuc2x1Z30vYDsKICAgICAgQVBJU2VydmljZShlbmRwb2ludCkudGhlbihkYXRhID0+IHsKICAgICAgICBpZihkYXRhKSB7CiAgICAgICAgICB0aGlzLnF1ZXN0aW9uID0gZGF0YTsKICAgICAgICAgIHRoaXMudXNlckhhc0Fuc3dlcmVkID0gZGF0YS51c2VyX2hhc19hbnN3ZXJlZDsKICAgICAgICAgIHRoaXMuc2V0UGFnZVRpdGxlKGRhdGEuY29udGVudCk7CgogICAgICAgIH1lbHNlIHsKICAgICAgICAgIHRoaXMucXVlc3Rpb24gPSBudWxsOwogICAgICAgICAgdGhpcy5zZXRQYWdlVGl0bGUoIjQwNCBFcnJvciIpOwogICAgICAgIH0KICAgICAgICAKICAgICAgfSk7CiAgICB9LAogICAgZ2V0UXVlc3Rpb25BbnN3ZXJzKCkgewogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9xdWVzdGlvbnMvJHt0aGlzLnNsdWd9L2Fuc3dlcnMvYDsKICAgICAgaWYgKHRoaXMubmV4dCkgewogICAgICAgIGVuZHBvaW50ID0gdGhpcy5uZXh0OwogICAgICB9CiAgICAgIHRoaXMubG9hZGluZ0Fuc3dlcnMgPSB0cnVlOwogICAgICBBUElTZXJ2aWNlKGVuZHBvaW50KS50aGVuKGRhdGEgPT4gewogICAgICAgIHRoaXMuYW5zd2Vycy5wdXNoKC4uLmRhdGEucmVzdWx0cyk7CiAgICAgICAgdGhpcy5sb2FkaW5nQW5zd2VycyA9IGZhbHNlOwogICAgICAgIGlmIChkYXRhLm5leHQpIHsKICAgICAgICAgIHRoaXMubmV4dCA9IGRhdGEubmV4dDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBhc3luYyBkZWxldGVBbnN3ZXIoYW5zd2VyKSB7CiAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL2Fuc3dlcnMvJHthbnN3ZXIuaWR9L2A7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgQVBJU2VydmljZShlbmRwb2ludCwgIkRFTEVURSIpOwogICAgICAgIHRoaXMuJGRlbGV0ZSh0aGlzLmFuc3dlcnMsIHRoaXMuYW5zd2Vycy5pbmRleE9mKGFuc3dlcikpOwogICAgICAgIHRoaXMudXNlckhhc0Fuc3dlcmVkID0gZmFsc2U7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBpc1F1ZXN0aW9uQXV0aG9yKCkgewogICAgICBsZXQgcmVzcCA9IGF3YWl0IGF4aW9zLmdldCgiaHR0cDovLzEyNy4wLjAuMTo4MDAwL2FwaS9xdWVzdGlvbnMvIik7CiAgICAgIGxldCBxX29iaiA9IHJlc3AuZGF0YS5yZXN1bHRzOwogICAgICBsZXQgY3VycmVudF91c2VyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImF1dGhvciIpOwogICAgICBsZXQgcmVzdWx0ID0gcV9vYmouZmlsdGVyKG9iaiA9PiB7CiAgICAgICAgcmV0dXJuIG9iai5hdXRob3IgPT09IGN1cnJlbnRfdXNlcjsKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLnF1ZXN0aW9uLmF1dGhvciA9PT0gY3VycmVudF91c2VyKSB7CiAgICAgICAgdGhpcy5zaG93RWRpdFF1ZXN0aW9uID0gdHJ1ZTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGRlbGV0ZVF1ZXN0aW9uKCkgewogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9xdWVzdGlvbnMvJHt0aGlzLnNsdWd9YDsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBBUElTZXJ2aWNlKGVuZHBvaW50LCAiREVMRVRFIik7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9jb3JlIik7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgIH0KICAgIH0sCgogICAgb25TdWJtaXQoKSB7CiAgICAgIGlmICh0aGlzLm5ld0Fuc3dlckJvZHkpIHsKICAgICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9xdWVzdGlvbnMvJHt0aGlzLnNsdWd9L2Fuc3dlci9gOwogICAgICAgIEFQSVNlcnZpY2UoZW5kcG9pbnQsICJQT1NUIiwgeyBib2R5OiB0aGlzLm5ld0Fuc3dlckJvZHkgfSkudGhlbigKICAgICAgICAgIGRhdGEgPT4gewogICAgICAgICAgICB0aGlzLmFuc3dlcnMudW5zaGlmdChkYXRhKTsKICAgICAgICAgICAgdGhpcy5zaG93Rm9ybSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnVzZXJIYXNBbnN3ZXJlZCA9IHRydWU7CiAgICAgICAgICAgIGlmICh0aGlzLmVycm9yKSB7CiAgICAgICAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICApOwogICAgICAgIHRoaXMubmV3QW5zd2VyQm9keSA9IG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lcnJvciA9ICJZb3UgY2Fubm90IHNlbmQgYW4gZW1wdHkgYW5zd2VyISI7CiAgICAgIH0KICAgIH0sCiAgICBzdWJtaXRVcGRhdGVkUXVlc3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLnF1ZXN0aW9uQm9keSkgewogICAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL3F1ZXN0aW9ucy8ke3RoaXMuc2x1Z30vYDsKICAgICAgICBBUElTZXJ2aWNlKGVuZHBvaW50LCAiUFVUIiwgeyBjb250ZW50OiB0aGlzLnF1ZXN0aW9uQm9keSB9KS50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogImhvbWUiLAogICAgICAgICAgICBwYXJhbXM6IHsgc2x1ZzogdGhpcy5xdWVzdGlvblNsdWcgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lcnJvciA9ICJSZXF1aXJlZCBmaWVsZCEiOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgYmVmb3JlUm91dGVFbnRlcih0bywgZnJvbSwgbmV4dCkgewogICAgICAvLyBnZXQgdGhlIGFuc3dlcidzIGRhdGEgZnJvbSB0aGUgUkVTVCBBUEkgYW5kIHNldCB0d28gZGF0YSBwcm9wZXJ0aWVzIGZvciB0aGUgY29tcG9uZW50CiAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL3F1ZXN0aW9ucy8ke3RvLnBhcmFtcy5zbHVnfS9gOwogICAgICBsZXQgZGF0YSA9IGF3YWl0IEFQSVNlcnZpY2UoZW5kcG9pbnQpOwogICAgICByZXR1cm4gbmV4dCh2bSA9PiAodm0ucXVlc3Rpb25Cb2R5ID0gZGF0YS5jb250ZW50KSk7CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRRdWVzdGlvbkRhdGEoKTsKICAgIHRoaXMuZ2V0UXVlc3Rpb25BbnN3ZXJzKCk7CiAgICB0aGlzLnNldFJlcXVlc3RVc2VyKCk7CiAgICB0aGlzLmlzUXVlc3Rpb25BdXRob3IoKTsKICAgIC8vdGhpcy5kZWxldGVRdWVzdGlvbigpCiAgfQp9Owo="},{"version":3,"sources":["Question.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Question.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"single-question\">\n    <div class=\"container\" v-if=\"question\">\n      <h2>{{ question.content }}</h2>\n      <div v-if=\"showEditQuestion\">\n        <!-- <router-link\n          :to=\"{ name: 'update-question', params: { slug: question.slug }}\"\n          class=\"btn btn-sm btn-outline-secondary mr-1\"\n        >Edit</router-link>-->\n        <button\n          onclick=\"document.getElementById('id01').style.display='block'\"\n          class=\"btn btn-sm btn-outline-secondary mr-1\"\n        >Update Question</button>\n\n        <div id=\"id01\" class=\"w3-modal mt-5 bg-dark\">\n          <div class=\"w3-modal-content w3-animate-opacity w3-card-4\">\n            <header class=\"container bg-light py-2\">\n              <span\n                onclick=\"document.getElementById('id01').style.display='none'\"\n                class=\"w3-button w3-display-topright\"\n              >&times;</span>\n              <h6>\n                Update:\n                <span class=\"w3-text-red\">{{ question.content }}</span>\n              </h6>\n            </header>\n            <div class=\"container my-3\">\n              <form @submit.prevent=\"submitUpdatedQuestion\">\n                <textarea\n                  v-model=\"questionBody\"\n                  class=\"form-control mb-4\"\n                  rows=\"3\"\n                  placeholder=\"Update here...\"\n                ></textarea>\n                <button type=\"submit\" class=\"btn btn-success mb-3\">Submit update</button>\n              </form>\n            </div>\n          </div>\n        </div>\n        <button class=\"btn btn-sm btn-outline-danger my-2\" @click=\"deleteQuestion\">Delete Question</button>\n      </div>\n\n      <p class=\"mb-0\">\n        Posted by:\n        <span class=\"w3-text-red\">{{ question.author }}</span>\n      </p>\n      <p class=\"text-secondary\">{{ question.created }}</p>\n      <hr />\n      <div v-if=\"userHasAnswered\">\n        <p class=\"answer-added\">You've written an answer!</p>\n      </div>\n      <div v-else-if=\"showForm\">\n        <form class=\"card\" @submit.prevent=\"onSubmit\">\n          <div class=\"card-header px-3\">Answer thje question</div>\n          <div class=\"card-block\">\n            <textarea\n              v-model=\"newAnswerBody\"\n              class=\"form-control\"\n              placeholder=\"Share your knowledge\"\n              rows=\"5\"\n            ></textarea>\n          </div>\n          <div class=\"card-footer px-3\">\n            <button class=\"btn btn-sm btn-success\">Submit your answer</button>\n          </div>\n        </form>\n        <p v-if=\"error\" class=\"text-danger mt-2\">{{ error }}</p>\n      </div>\n      <div v-else>\n        <button class=\"btn bt-sm btn-success\" @click=\"showForm = true\">Answer the question</button>\n      </div>\n      <hr />\n    </div>\n    <div v-else>\n      <h2 class=\"w3-text-red\">404 - Not Found</h2>\n\n    </div>\n\n    <div class=\"container\" v-if=\"question\">\n      <AnswerComponent\n        v-for=\"answer in answers\"\n        :answer=\"answer\"\n        :key=\"answer.id\"\n        :requestUser=\"requestUser\"\n        @delete-answer=\"deleteAnswer\"\n      />\n      <div class=\"my-4\">\n        <p v-show=\"loadingAnswers\">...load...</p>\n        <button\n          v-show=\"next\"\n          @click=\"getQuestionAnswers\"\n          class=\"btn btn-sm btn-outline-success\"\n        >Load more...</button>\n      </div>\n    </div>\n\n    <PreventUnload :when=\"hasChanges\"/>\n  </div>\n</template>\n\n<script>\nimport { APIService } from \"../common/api.service.js\";\nimport PreventUnload from 'vue-prevent-unload';\nimport QuestionActions from \"@/components/common-components/QuestionActions.vue\";\nimport AnswerComponent from \"@/components/common-components/Answer.vue\";\nimport axios from \"axios\";\nexport default {\n  name: \"Question\",\n  props: {\n    slug: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    AnswerComponent,\n    QuestionActions,\n    PreventUnload\n  },\n  data() {\n    return {\n      question: {},\n      answers: [],\n      newAnswerBody: [],\n      error: null,\n      userHasAnswered: false,\n      showForm: false,\n      next: null,\n      loadingAnswers: false,\n      hasChanges: true,\n      requestUser: null,\n      showEditQuestion: false,\n      questionSlug: null,\n      questionBody: null\n    };\n  },\n\n  methods: {\n    setRequestUser() {\n      // the username has been set to localStorage by the App.vue component\n      this.requestUser = localStorage.getItem(\"author\");\n    },\n    setPageTitle(title) {\n      document.title = title;\n    },\n    getQuestionData() {\n      let endpoint = `/api/questions/${this.slug}/`;\n      APIService(endpoint).then(data => {\n        if(data) {\n          this.question = data;\n          this.userHasAnswered = data.user_has_answered;\n          this.setPageTitle(data.content);\n\n        }else {\n          this.question = null;\n          this.setPageTitle(\"404 Error\");\n        }\n        \n      });\n    },\n    getQuestionAnswers() {\n      let endpoint = `/api/questions/${this.slug}/answers/`;\n      if (this.next) {\n        endpoint = this.next;\n      }\n      this.loadingAnswers = true;\n      APIService(endpoint).then(data => {\n        this.answers.push(...data.results);\n        this.loadingAnswers = false;\n        if (data.next) {\n          this.next = data.next;\n        } else {\n          this.next = null;\n        }\n      });\n    },\n\n    async deleteAnswer(answer) {\n      let endpoint = `/api/answers/${answer.id}/`;\n      try {\n        await APIService(endpoint, \"DELETE\");\n        this.$delete(this.answers, this.answers.indexOf(answer));\n        this.userHasAnswered = false;\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    async isQuestionAuthor() {\n      let resp = await axios.get(\"http://127.0.0.1:8000/api/questions/\");\n      let q_obj = resp.data.results;\n      let current_user = localStorage.getItem(\"author\");\n      let result = q_obj.filter(obj => {\n        return obj.author === current_user;\n      });\n      if (this.question.author === current_user) {\n        this.showEditQuestion = true;\n      }\n    },\n    async deleteQuestion() {\n      let endpoint = `/api/questions/${this.slug}`;\n      try {\n        await APIService(endpoint, \"DELETE\");\n        this.$router.push(\"/core\");\n      } catch (err) {\n        console.log(err);\n      }\n    },\n\n    onSubmit() {\n      if (this.newAnswerBody) {\n        let endpoint = `/api/questions/${this.slug}/answer/`;\n        APIService(endpoint, \"POST\", { body: this.newAnswerBody }).then(\n          data => {\n            this.answers.unshift(data);\n            this.showForm = false;\n            this.userHasAnswered = true;\n            if (this.error) {\n              this.error = null;\n            }\n          }\n        );\n        this.newAnswerBody = null;\n      } else {\n        this.error = \"You cannot send an empty answer!\";\n      }\n    },\n    submitUpdatedQuestion() {\n      if (this.questionBody) {\n        let endpoint = `/api/questions/${this.slug}/`;\n        APIService(endpoint, \"PUT\", { content: this.questionBody }).then(() => {\n          this.$router.push({\n            name: \"home\",\n            params: { slug: this.questionSlug }\n          });\n        });\n      } else {\n        this.error = \"Required field!\";\n      }\n    },\n    async beforeRouteEnter(to, from, next) {\n      // get the answer's data from the REST API and set two data properties for the component\n      let endpoint = `/api/questions/${to.params.slug}/`;\n      let data = await APIService(endpoint);\n      return next(vm => (vm.questionBody = data.content));\n    }\n  },\n  created() {\n    this.getQuestionData();\n    this.getQuestionAnswers();\n    this.setRequestUser();\n    this.isQuestionAuthor();\n    //this.deleteQuestion()\n  }\n};\n</script>\n \n\n<style scoped>\n.single-question {\n  margin: 100px 30px;\n}\n\n.answer-added {\n  font-weight: bold;\n  color: green;\n}\n.error {\n  font-weight: bold;\n  color: red;\n}\n</style>"]}]}