{"remainingRequest":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/engine/Documents/D-VJ/QA2/qa/frontend/src/views/Question.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/src/views/Question.vue","mtime":1590516925434},{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1588785011040},{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/babel-loader/lib/index.js","mtime":1584985692138},{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1588785011040},{"path":"/Users/engine/Documents/D-VJ/QA2/qa/frontend/node_modules/vue-loader/lib/index.js","mtime":1588785012576}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEFQSVNlcnZpY2UgfSBmcm9tICIuLi9jb21tb24vYXBpLnNlcnZpY2UuanMiOwppbXBvcnQgUHJldmVudFVubG9hZCBmcm9tICd2dWUtcHJldmVudC11bmxvYWQnOwppbXBvcnQgQW5zd2VyQ29tcG9uZW50IGZyb20gIkAvY29tcG9uZW50cy9jb21tb24tY29tcG9uZW50cy9BbnN3ZXIudnVlIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKZXhwb3J0IGRlZmF1bHQgewoKICBuYW1lOiAiUXVlc3Rpb24iLAogIHByb3BzOiB7CiAgICBzbHVnOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEFuc3dlckNvbXBvbmVudCwKICAgIFByZXZlbnRVbmxvYWQKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBxdWVzdGlvbjoge30sCiAgICAgIGFuc3dlcnM6IFtdLAogICAgICBuZXdBbnN3ZXJCb2R5OiBbXSwKICAgICAgZXJyb3I6IG51bGwsCiAgICAgIHVzZXJIYXNBbnN3ZXJlZDogZmFsc2UsCiAgICAgIHNob3dGb3JtOmZhbHNlLAogICAgICBuZXh0OiBudWxsLAogICAgICBsb2FkaW5nQW5zd2VyczogZmFsc2UsCiAgICAgIGhhc0NoYW5nZXM6IHRydWUsCiAgICAgIHJlcXVlc3RVc2VyOiBudWxsCiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgIHNldFJlcXVlc3RVc2VyKCkgewogICAgICAvLyB0aGUgdXNlcm5hbWUgaGFzIGJlZW4gc2V0IHRvIGxvY2FsU3RvcmFnZSBieSB0aGUgQXBwLnZ1ZSBjb21wb25lbnQKICAgICAgdGhpcy5yZXF1ZXN0VXNlciA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiZW1haWwiKTsKICAgIH0sCiAgICBzZXRQYWdlVGl0bGUodGl0bGUpIHsKICAgICAgZG9jdW1lbnQudGl0bGUgPSB0aXRsZTsKCiAgICB9LAogICAgZ2V0UXVlc3Rpb25EYXRhKCkgewogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9xdWVzdGlvbnMvJHt0aGlzLnNsdWd9L2A7CiAgICAgIEFQSVNlcnZpY2UoZW5kcG9pbnQpCiAgICAgICAgLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgICB0aGlzLnF1ZXN0aW9uID0gZGF0YTsKICAgICAgICAgIHRoaXMudXNlckhhc0Fuc3dlcmVkID0gZGF0YS51c2VyX2hhc19hbnN3ZXJlZDsKICAgICAgICAgIHRoaXMuc2V0UGFnZVRpdGxlKGRhdGEuY29udGVudCkKICAgICAgICB9KQogICAgfSwKICAgIGdldFF1ZXN0aW9uQW5zd2VycygpIHsKICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvcXVlc3Rpb25zLyR7dGhpcy5zbHVnfS9hbnN3ZXJzL2A7CiAgICAgIGlmICh0aGlzLm5leHQpIHsKICAgICAgICBlbmRwb2ludCA9IHRoaXMubmV4dDsKICAgICAgfQogICAgICB0aGlzLmxvYWRpbmdBbnN3ZXJzID0gdHJ1ZTsKICAgICAgQVBJU2VydmljZShlbmRwb2ludCkKICAgICAgICAudGhlbihkYXRhID0+IHsKICAgICAgICAgIHRoaXMuYW5zd2Vycy5wdXNoKC4uLmRhdGEucmVzdWx0cyk7CiAgICAgICAgICB0aGlzLmxvYWRpbmdBbnN3ZXJzID0gZmFsc2U7CiAgICAgICAgICBpZiAoZGF0YS5uZXh0KSB7CiAgICAgICAgICAgIHRoaXMubmV4dCA9IGRhdGEubmV4dDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMubmV4dCA9IG51bGw7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgIH0sCiAgICBvblN1Ym1pdCgpIHsKICAgICAgaWYodGhpcy5uZXdBbnN3ZXJCb2R5KSB7CiAgICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvcXVlc3Rpb25zLyR7dGhpcy5zbHVnfS9hbnN3ZXIvYDsKICAgICAgICBBUElTZXJ2aWNlKGVuZHBvaW50LCAiUE9TVCIsIHsgYm9keTogdGhpcy5uZXdBbnN3ZXJCb2R5IH0pCiAgICAgICAgLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgICB0aGlzLmFuc3dlcnMudW5zaGlmdChkYXRhKQogICAgICAgICAgdGhpcy5zaG93Rm9ybSA9IGZhbHNlOwogICAgICAgICAgdGhpcy51c2VySGFzQW5zd2VyZWQgPSB0cnVlOwogICAgICAgICAgaWYodGhpcy5lcnJvcikgewogICAgICAgICAgICB0aGlzLmVycm9yID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIHRoaXMubmV3QW5zd2VyQm9keSA9IG51bGw7CiAgICAgIH1lbHNlIHsKICAgICAgICB0aGlzLmVycm9yID0gIllvdSBjYW5ub3Qgc2VuZCBhbiBlbXB0eSBhbnN3ZXIhIgogICAgICB9CiAgICB9LAogICAgYXN5bmMgZGVsZXRlQW5zd2VyKGFuc3dlcikgewogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9hbnN3ZXJzLyR7YW5zd2VyLmlkfS9gOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IEFQSVNlcnZpY2UoZW5kcG9pbnQsICJERUxFVEUiKTsKICAgICAgICB0aGlzLiRkZWxldGUodGhpcy5hbnN3ZXJzLCB0aGlzLmFuc3dlcnMuaW5kZXhPZihhbnN3ZXIpKTsKICAgICAgICB0aGlzLnVzZXJIYXNBbnN3ZXJlZCA9IGZhbHNlOwogICAgICB9Y2F0Y2goZXJyKXsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgIH0KICAgIH0KICAgIAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0UXVlc3Rpb25EYXRhKCkKICAgIHRoaXMuZ2V0UXVlc3Rpb25BbnN3ZXJzKCkKICAgIHRoaXMuc2V0UmVxdWVzdFVzZXIoKQoKICB9CiAKfQo="},{"version":3,"sources":["Question.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA","file":"Question.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"single-question\">\n    <div class=\"container\">\n      <h2>{{ question.content }}</h2>\n      <p class=\"mb-0\">Posted by: \n        <span class=\"w3-text-red\">{{ question.author }}</span>\n      </p>\n      <p class=\"text-secondary\">{{ question.created }}</p>\n      <hr>\n      <div v-if=\"userHasAnswered\">\n        <p class=\"answer-added\">You've written an answer!</p>\n      </div>\n      <div v-else-if=\"showForm\">\n        <form class=\"card\" @submit.prevent=\"onSubmit\">\n          <div class=\"card-header px-3\">Answer thje question</div>\n          <div class=\"card-block\">\n            <textarea v-model=\"newAnswerBody\" class=\"form-control\" placeholder=\"Share your knowledge\" rows=\"5\"></textarea>\n          </div>\n          <div class=\"card-footer px-3\">\n            <button class=\"btn btn-sm btn-success\">Submit your answer</button>\n\n          </div>\n        </form>\n        <p v-if=\"error\" class=\"text-danger mt-2\">{{ error }}</p>\n      </div>\n      <div v-else>\n        <button class=\"btn bt-sm btn-success\" @click=\"showForm = true\">\n          Answer the question\n        </button>\n      </div>\n      <hr>\n    </div>\n   \n    <div class=\"container\">\n      <AnswerComponent\n        v-for=\"answer in answers\"\n        :answer=\"answer\"\n        :key=\"answer.id\"\n        :requestUser=\"requestUser\"\n        @delete-answer=\"deleteAnswer\"\n      />\n      <div class=\"my-4\">\n        <p v-show=\"loadingAnswers\">...load...</p>\n          <button \n            v-show=\"next\"\n            @click=\"getQuestionAnswers\"\n            class=\"btn btn-sm btn-outline-success\"\n            >Load more...</button>\n      </div>\n      \n    </div>\n    \n    \n    <PreventUnload :when=\"hasChanges\"/>\n   \n   \n  </div>\n \n  \n</template>\n\n<script>\nimport { APIService } from \"../common/api.service.js\";\nimport PreventUnload from 'vue-prevent-unload';\nimport AnswerComponent from \"@/components/common-components/Answer.vue\";\nimport axios from \"axios\";\nexport default {\n\n  name: \"Question\",\n  props: {\n    slug: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    AnswerComponent,\n    PreventUnload\n  },\n  data() {\n    return {\n      question: {},\n      answers: [],\n      newAnswerBody: [],\n      error: null,\n      userHasAnswered: false,\n      showForm:false,\n      next: null,\n      loadingAnswers: false,\n      hasChanges: true,\n      requestUser: null\n    }\n  },\n\n  methods: {\n     setRequestUser() {\n      // the username has been set to localStorage by the App.vue component\n      this.requestUser = window.localStorage.getItem(\"email\");\n    },\n    setPageTitle(title) {\n      document.title = title;\n\n    },\n    getQuestionData() {\n      let endpoint = `/api/questions/${this.slug}/`;\n      APIService(endpoint)\n        .then(data => {\n          this.question = data;\n          this.userHasAnswered = data.user_has_answered;\n          this.setPageTitle(data.content)\n        })\n    },\n    getQuestionAnswers() {\n      let endpoint = `/api/questions/${this.slug}/answers/`;\n      if (this.next) {\n        endpoint = this.next;\n      }\n      this.loadingAnswers = true;\n      APIService(endpoint)\n        .then(data => {\n          this.answers.push(...data.results);\n          this.loadingAnswers = false;\n          if (data.next) {\n            this.next = data.next;\n          } else {\n            this.next = null;\n          }\n        })\n    },\n    onSubmit() {\n      if(this.newAnswerBody) {\n        let endpoint = `/api/questions/${this.slug}/answer/`;\n        APIService(endpoint, \"POST\", { body: this.newAnswerBody })\n        .then(data => {\n          this.answers.unshift(data)\n          this.showForm = false;\n          this.userHasAnswered = true;\n          if(this.error) {\n            this.error = null;\n          }\n        })\n        this.newAnswerBody = null;\n      }else {\n        this.error = \"You cannot send an empty answer!\"\n      }\n    },\n    async deleteAnswer(answer) {\n      let endpoint = `/api/answers/${answer.id}/`;\n      try {\n        await APIService(endpoint, \"DELETE\");\n        this.$delete(this.answers, this.answers.indexOf(answer));\n        this.userHasAnswered = false;\n      }catch(err){\n        console.log(err)\n      }\n    }\n    \n  },\n  created() {\n    this.getQuestionData()\n    this.getQuestionAnswers()\n    this.setRequestUser()\n\n  }\n \n}\n</script>\n \n\n<style scoped>\n  .single-question {\n    margin: 100px 30px;\n  }\n\n  .answer-added{\n    font-weight: bold;\n    color: green;\n  }\n  .error {\n    font-weight: bold;\n    color: red;\n  }\n\n</style>"]}]}